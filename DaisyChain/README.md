# SandGrain Daisy Chain Authentication Utilities

This repository contains two Python scripts designed for generating and verifying **Daisy Chain authentication data** using the SandGrain CyberRock device ecosystem. These tools facilitate secure hostâ€“device challengeâ€“response authentication and ensure integrity verification between hardware tokens and cloud services.

---

## ğŸ“œ Scripts Overview

### 1. `CreateDaisyChainData.py`
Generates a JSON file containing authentication data (Daisy Chain) for a device.

**Features:**
- Uses device TID (Token ID) to bind authentication data.
- Creates a chain of cryptographic hashes (HCW1 â†’ HRW1 â†’ HRW2 â†’ HRW3).
- Outputs all intermediate data to a structured JSON file.
- Designed for use on a Raspberry Pi with SandGrain Token hardware.

**Output Example (`example.json`):**
```json
{
    "name": "example.json",
    "TID": "123456789ABCDEF",
    "HCW1": "af45...",
    "data1": "b22e...",
    "data2": "e9d1...",
    "HRW3": "3f9a..."
}
```

**Usage:**
```bash
python3 CreateDaisyChainData.py <filename_without_extension>
```

This will create `<filename>.json` in the working directory.

---

### 2. `LocalVerifyDaisyChainData.py`
Verifies a previously created Daisy Chain data file by cross-checking it with the CyberRock Cloud.

**Features:**
- Reads the JSON data generated by `CreateDaisyChainData.py`.
- Retrieves HRW values remotely from the cloud.
- Performs stepwise chain verification (HCW1 â†’ HRW1 â†’ HRW2 â†’ HRW3).
- Validates whether the device's HRW3 matches the claimed value.
- Prints the result of the verification.

**Usage:**
```bash
python3 LocalVerifyDaisyChainData.py <filename_without_extension>
```

**Example Output:**
```
Daisy Chain authenticated
```

If verification fails:
```
Daisy Chain not authentic!
```

---

## âš™ï¸ Environment Requirements

### Hardware
- Raspberry Pi with GPIO enabled
- SandGrain Token hardware device

### Software Dependencies
Install the following dependencies:

```bash
sudo apt-get install python3-rpi.gpio
pip install python-periphery requests
```

### Required Local Modules
These scripts depend on modules provided by the SandGrain Suite Device API, located in:
```
/home/pi/SandGrain/SandGrainSuite_DeviceAPI/
â”œâ”€â”€ CyberRock_Cloud.py
â”œâ”€â”€ CyberRock_Token.py
â””â”€â”€ SandGrain_Credentials.py
```

### Credentials
Ensure your `SandGrain_Credentials.py` contains valid authentication fields:
```python
cloudflaretokens = "<your_cloudflare_token>"
iotusername = "<your_iot_username>"
iotpassword = "<your_iot_password>"
```

Keep this file secure and never publish it publicly.

---

## ğŸ§© Functions Summary

| Function | Description |
|-----------|-------------|
| `gpio_setup()` | Initializes Raspberry Pi GPIO pins for token operations. |
| `listToInt(lst)` | Converts a byte list to an integer. |
| `intToList(number)` | Converts an integer into a list of byte-sized integers. |
| `main()` | Core function that executes the creation or verification logic. |

---

## ğŸ§  Workflow Summary

1. **Generate Data:** Run `CreateDaisyChainData.py` to create a secure JSON file.
2. **Verify Data:** Run `LocalVerifyDaisyChainData.py` using the generated file.
3. **Result:** The second script confirms whether the chain is valid (authenticated).

---

## ğŸ› ï¸ Author

**Your Name**  
SandGrain Cybersecurity / IoT Authentication Team  
ğŸ“§ your.email@example.com  

---

## ğŸ“ License

This project is proprietary and intended for internal use within the SandGrain suite ecosystem.  
Do not distribute or modify without authorization.

---
